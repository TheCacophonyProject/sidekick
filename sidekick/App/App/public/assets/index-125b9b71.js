import{h as R,w as E,a as N,b as A,i as l,c as r,B as _,A as h,j as b,k as v,l as P,t as g,g as k,r as m,J as T}from"./index-33b209e3.js";import{A as p}from"./ActionContainer-7b05aa46.js";import{C as z}from"./CircleButton-7bf58bb2.js";import{D}from"./index-0836cc50.js";const B=g('<button class="text-red-400"></button>',2),C=g('<span class="w-24">Saved: <!> </span>',3),S=g('<span class="ml-2">Uploaded: </span>',2),U=g('<p class="flex items-center text-gray-800"><span class="w-24">Saved: <!> </span><span class="ml-2">Uploaded: </span></p>',7),j=g('<section class="pb-bar pt-bar relative h-full space-y-2 overflow-y-auto bg-gray-200 px-2"><div class="pb-bar fixed inset-x-0 bottom-[4vh] mx-auto flex justify-center"></div></section>',4);function L(){const n=R(),a=E(),[x,f]=N(!1),y=async()=>{const{value:t}=await D.confirm({title:"Delete Recordings",message:"Are you sure you want to delete all saved items? Note: Uploaded items will not be deleted, until the device is notified"});t&&(await n.deleteRecordings(),await n.deleteEvents({uploaded:!1}))};A(()=>{const t=m.get("/storage");t&&(m.set("/storage",[t[0],(()=>{const o=B.cloneNode(!0);return o.$$click=y,l(o,r(T,{size:32})),o})()]),console.log(m.get("/storage")))});const w=async()=>{f(!0);try{if(!a||(await a.validateCurrToken(),!a.isAuthorized))return;await Promise.all([n.uploadRecordings(),n.uploadEvents()]),f(!1)}catch{f(!1)}},$=t=>t.isProd===a.isProd(),u=t=>!t.isProd;return(()=>{const t=j.cloneNode(!0),o=t.firstChild;return l(t,r(p,{icon:_,header:"Recordings",get action(){return r(h,{href:"recordings",class:"text-blue-500",get children(){return r(b,{size:32})}})},get children(){return r(h,{href:"recordings",class:"flex items-center text-gray-800",get children(){return[(()=>{const e=C.cloneNode(!0),s=e.firstChild,i=s.nextSibling;return i.nextSibling,l(e,()=>n.UnuploadedRecordings().length,i),e})(),(()=>{const e=S.cloneNode(!0);return e.firstChild,l(e,()=>n.UploadedRecordings().length,null),e})()]}})}}),o),l(t,r(p,{icon:v,header:"Events",get children(){const e=U.cloneNode(!0),s=e.firstChild,i=s.firstChild,d=i.nextSibling;d.nextSibling;const c=s.nextSibling;return c.firstChild,l(s,()=>n.UnuploadedEvents().length,d),l(c,()=>n.UploadedEvents().length,null),e}}),o),l(t,r(P,{get when(){return!a.isProd()},get children(){return[r(p,{icon:_,header:"Test Recordings",get action(){return r(h,{href:"recordings",class:"text-blue-500",get children(){return r(b,{size:32})}})},get children(){return r(h,{href:"recordings",class:"flex items-center text-gray-800",get children(){return[(()=>{const e=C.cloneNode(!0),s=e.firstChild,i=s.nextSibling;return i.nextSibling,l(e,()=>n.UnuploadedRecordings().filter(u).length,i),e})(),(()=>{const e=S.cloneNode(!0);return e.firstChild,l(e,()=>n.UploadedRecordings().filter(u).length,null),e})()]}})}}),r(p,{icon:v,header:"Events",get children(){const e=U.cloneNode(!0),s=e.firstChild,i=s.firstChild,d=i.nextSibling;d.nextSibling;const c=s.nextSibling;return c.firstChild,l(s,()=>n.UnuploadedEvents().filter(u).length,d),l(c,()=>n.UploadedEvents().filter(u).length,null),e}})]}}),o),l(o,r(z,{get text(){return a.isProd()?"Upload to Cacophony":"Upload to Cacophony Test"},loadingText:"Uploading...",onClick:w,get disabled(){return x()||n.UnuploadedRecordings().filter($).length===0&&n.UnuploadedEvents().filter($).length===0},get loading(){return x()}})),t})()}k(["click"]);export{L as default};
